<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2188px" preserveAspectRatio="none" style="width:1073px;height:2188px;" version="1.1" viewBox="0 0 1073 2188" width="1073px" zoomAndPan="magnify"><defs/><g><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="66" x="577.5" y="1256.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="584.5" y="1276.957">Forums</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="86" x2="86" y1="34.4883" y2="2147.9844"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="542.5" x2="542.5" y1="34.4883" y2="2147.9844"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="610.5" x2="610.5" y1="1285.5996" y2="2147.9844"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="878" x2="878" y1="34.4883" y2="2147.9844"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1025" x2="1025" y1="34.4883" y2="2147.9844"/><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="69" x="52" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="59" y="23.5352">Browser</text><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="69" x="52" y="2146.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="59" y="2167.5195">Browser</text><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="50" x="517.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="524.5" y="23.5352">Store</text><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="50" x="517.5" y="2146.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="524.5" y="2167.5195">Store</text><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="66" x="577.5" y="2146.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="584.5" y="2167.5195">Forums</text><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="93" x="832" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="839" y="23.5352">FusionAuth</text><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="93" x="832" y="2146.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="839" y="2167.5195">FusionAuth</text><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="61" x="995" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="1002" y="23.5352">Hacker</text><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="61" x="995" y="2146.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="1002" y="2167.5195">Hacker</text><path d="M56,49.4883 L56,104.4883 L1055,104.4883 L1055,59.4883 L1045,49.4883 L56,49.4883 " fill="#ADD8E6" style="stroke: #6495ED; stroke-width: 1.0;"/><path d="M1045,49.4883 L1045,59.4883 L1055,59.4883 L1045,49.4883 " fill="#ADD8E6" style="stroke: #6495ED; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="445.5" y="67.0566">[] = cookies</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="445.5" y="82.3672">{} = request/response parameters</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="445.5" y="97.6777">() = request/response body</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="131.0752"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="131.0752" y2="131.0752"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="134.0752" y2="134.0752"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="72" x="496" y="120.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="502" y="136.9883">Initialize</text><polygon fill="#000000" points="530.5,171.041,540.5,175.041,530.5,179.041,534.5,175.041" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="536.5" y1="175.041" y2="175.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="93.5" y="170.2988">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="106.5" y="170.2988">GET /</text><polygon fill="#000000" points="97.5,200.3516,87.5,204.3516,97.5,208.3516,93.5,204.3516" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="541.5" y1="204.3516" y2="204.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="103.5" y="199.6094">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="116.5" y="199.6094">(HTML, CSS &amp; JavaScript - with login link)</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="233.0068"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="233.0068" y2="233.0068"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="236.0068" y2="236.0068"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="158" x="453" y="222.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="459" y="238.9199">Login (inside WebApp)</text><polygon fill="#000000" points="530.5,272.9727,540.5,276.9727,530.5,280.9727,534.5,276.9727" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="536.5" y1="276.9727" y2="276.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="93.5" y="272.2305">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="106.5" y="272.2305">GET /login</text><polygon fill="#000000" points="97.5,302.2832,87.5,306.2832,97.5,310.2832,93.5,306.2832" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="541.5" y1="306.2832" y2="306.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="103.5" y="301.541">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="116.5" y="301.541">(Login form HTML)</text><polygon fill="#000000" points="530.5,331.5938,540.5,335.5938,530.5,339.5938,534.5,335.5938" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="536.5" y1="335.5938" y2="335.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="93.5" y="330.8516">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="106.5" y="330.8516">POST /login</text><polygon fill="#000000" points="866.5,360.9043,876.5,364.9043,866.5,368.9043,870.5,364.9043" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="542.5" x2="872.5" y1="364.9043" y2="364.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="549.5" y="360.1621">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="562.5" y="360.1621">POST /api/login</text><polygon fill="#000000" points="553.5,390.2148,543.5,394.2148,553.5,398.2148,549.5,394.2148" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="547.5" x2="877.5" y1="394.2148" y2="394.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="559.5" y="389.4727">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="572.5" y="389.4727">(User, Refresh Token and JWT)</text><polygon fill="#000000" points="97.5,434.8359,87.5,438.8359,97.5,442.8359,93.5,438.8359" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="541.5" y1="438.8359" y2="438.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="103.5" y="426.4385">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="116.5" y="418.7832">302 Location: /shopping-cart</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="413" x="116.5" y="434.0938">[Refresh Token and JWT HttpOnly w/ domain: Store.Example.com]</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="467.4912"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="467.4912" y2="467.4912"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="470.4912" y2="470.4912"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="136" x="464" y="456.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="470" y="473.4043">Shopping cart load</text><polygon fill="#000000" points="530.5,522.7676,540.5,526.7676,530.5,530.7676,534.5,526.7676" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="536.5" y1="526.7676" y2="526.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="93.5" y="514.3701">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="106.5" y="506.7148">GET /shopping-cart</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="410" x="106.5" y="522.0254">[Refresh token and JWT HttpOnly w/ domain: Store.Example.com]</text><polygon fill="#000000" points="97.5,552.0781,87.5,556.0781,97.5,560.0781,93.5,556.0781" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="541.5" y1="556.0781" y2="556.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103.5" y="551.3359">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="125.5" y="551.3359">(Shopping cart HTML)</text><path d="M39,569.0781 L39,594.0781 L133,594.0781 L133,579.0781 L123,569.0781 L39,569.0781 " fill="#FF0000" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M123,569.0781 L123,579.0781 L133,579.0781 L123,569.0781 " fill="#FF0000" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="45" y="586.6465">JWT expires</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="620.0439"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="620.0439" y2="620.0439"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="623.0439" y2="623.0439"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="136" x="464" y="609.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="470" y="625.957">Shopping cart load</text><polygon fill="#000000" points="530.5,675.3203,540.5,679.3203,530.5,683.3203,534.5,679.3203" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="536.5" y1="679.3203" y2="679.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93.5" y="666.9229">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="115.5" y="659.2676">GET /shopping-cart</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="410" x="115.5" y="674.5781">[Refresh token and JWT HttpOnly w/ domain: Store.Example.com]</text><polygon fill="#000000" points="866.5,719.9414,876.5,723.9414,866.5,727.9414,870.5,723.9414" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="542.5" x2="872.5" y1="723.9414" y2="723.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="549.5" y="711.5439">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="290" x="571.5" y="703.8887">POST /oauth2/token or POST /api/jwt/refresh</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="571.5" y="719.1992">(grant_type=refresh and refresh token)</text><polygon fill="#000000" points="553.5,749.252,543.5,753.252,553.5,757.252,549.5,753.252" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="547.5" x2="877.5" y1="753.252" y2="753.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="559.5" y="748.5098">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="581.5" y="748.5098">(JWT)</text><polygon fill="#000000" points="97.5,793.873,87.5,797.873,97.5,801.873,93.5,797.873" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="541.5" y1="797.873" y2="797.873"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103.5" y="785.4756">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="125.5" y="777.8203">(Shopping cart HTML)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="323" x="125.5" y="793.1309">[New JWT HttpOnly w/ domain: Store.Example.com]</text><path d="M8,810.873 L8,835.873 L166,835.873 L166,820.873 L156,810.873 L8,810.873 " fill="#FF0000" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M156,810.873 L156,820.873 L166,820.873 L156,810.873 " fill="#FF0000" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="14" y="828.4414">Refresh token expires</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="861.8389"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="861.8389" y2="861.8389"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="864.8389" y2="864.8389"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="73" x="495.5" y="851.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="501.5" y="867.752">Re-login</text><polygon fill="#000000" points="530.5,917.1152,540.5,921.1152,530.5,925.1152,534.5,921.1152" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="536.5" y1="921.1152" y2="921.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93.5" y="908.7178">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="115.5" y="901.0625">GET /shopping-cart</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="410" x="115.5" y="916.373">[Refresh token and JWT HttpOnly w/ domain: Store.Example.com]</text><polygon fill="#000000" points="866.5,961.7363,876.5,965.7363,866.5,969.7363,870.5,965.7363" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="542.5" x2="872.5" y1="965.7363" y2="965.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="549.5" y="953.3389">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="290" x="571.5" y="945.6836">POST /oauth2/token or POST /api/jwt/refresh</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="571.5" y="960.9941">(grant_type=refresh and refresh token)</text><polygon fill="#FF0000" points="553.5,991.0469,543.5,995.0469,553.5,999.0469,549.5,995.0469" style="stroke: #FF0000; stroke-width: 1.0;"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="547.5" x2="877.5" y1="995.0469" y2="995.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="559.5" y="990.3047">17</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="581.5" y="990.3047">404 Missing</text><polygon fill="#000000" points="97.5,1020.3574,87.5,1024.3574,97.5,1028.3574,93.5,1024.3574" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="541.5" y1="1024.3574" y2="1024.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103.5" y="1019.6152">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="125.5" y="1019.6152">302 Location: /login</text><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="128.5" y1="1053.668" y2="1053.668"/><line style="stroke: #000000; stroke-width: 1.0;" x1="128.5" x2="128.5" y1="1053.668" y2="1066.668"/><line style="stroke: #000000; stroke-width: 1.0;" x1="87.5" x2="128.5" y1="1066.668" y2="1066.668"/><polygon fill="#000000" points="97.5,1062.668,87.5,1066.668,97.5,1070.668,93.5,1066.668" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93.5" y="1048.9258">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="115.5" y="1048.9258">Login same as above</text><path d="M56,1129.668 L56,1154.668 L1055,1154.668 L1055,1139.668 L1045,1129.668 L56,1129.668 " fill="#800080" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M1045,1129.668 L1045,1139.668 L1055,1139.668 L1045,1129.668 " fill="#800080" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="429" x="336.5" y="1147.2363">SSO login to forums - not provided by FusionAuth for this workflow</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="1230.6338"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="1230.6338" y2="1230.6338"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="1233.6338" y2="1233.6338"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="72" x="496" y="1219.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="502" y="1236.5469">Initialize</text><polygon fill="#000000" points="565.5,1285.9102,575.5,1289.9102,565.5,1293.9102,569.5,1289.9102" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="571.5" y1="1289.9102" y2="1289.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93.5" y="1277.5127">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="115.5" y="1269.8574">GET /</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="115.5" y="1285.168">[No cookies]</text><rect fill="#D3D3D3" height="30.4883" style="stroke: #808080; stroke-width: 1.5;" width="66" x="577.5" y="1256.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="584.5" y="1276.957">Forums</text><polygon fill="#000000" points="97.5,1315.2207,87.5,1319.2207,97.5,1323.2207,93.5,1319.2207" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="609.5" y1="1319.2207" y2="1319.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103.5" y="1314.4785">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="125.5" y="1314.4785">(HTML, CSS &amp; JavaScript - with login link)</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="1347.876"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="1347.876" y2="1347.876"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="1350.876" y2="1350.876"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="130" x="467" y="1337.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="473" y="1353.7891">Login (inside SPA)</text><polygon fill="#000000" points="598.5,1387.8418,608.5,1391.8418,598.5,1395.8418,602.5,1391.8418" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="604.5" y1="1391.8418" y2="1391.8418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93.5" y="1387.0996">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="115.5" y="1387.0996">GET /login</text><polygon fill="#000000" points="97.5,1417.1523,87.5,1421.1523,97.5,1425.1523,93.5,1421.1523" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="609.5" y1="1421.1523" y2="1421.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103.5" y="1416.4102">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="125.5" y="1416.4102">(Login form HTML)</text><polygon fill="#000000" points="598.5,1446.4629,608.5,1450.4629,598.5,1454.4629,602.5,1450.4629" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="604.5" y1="1450.4629" y2="1450.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93.5" y="1445.7207">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="115.5" y="1445.7207">POST /login</text><polygon fill="#000000" points="866.5,1475.7734,876.5,1479.7734,866.5,1483.7734,870.5,1479.7734" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="610.5" x2="872.5" y1="1479.7734" y2="1479.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="617.5" y="1475.0313">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="639.5" y="1475.0313">POST /api/login</text><polygon fill="#000000" points="621.5,1505.084,611.5,1509.084,621.5,1513.084,617.5,1509.084" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="615.5" x2="877.5" y1="1509.084" y2="1509.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="627.5" y="1504.3418">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="649.5" y="1504.3418">(User, Refresh Token and JWT)</text><polygon fill="#000000" points="97.5,1549.7051,87.5,1553.7051,97.5,1557.7051,93.5,1553.7051" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="609.5" y1="1553.7051" y2="1553.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103.5" y="1541.3076">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="125.5" y="1533.6523">302 Location: /posts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="428" x="125.5" y="1548.9629">[Refresh Token and JWT HttpOnly w/ domain: Forums.Example.com]</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="1582.3604"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="1582.3604" y2="1582.3604"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="1585.3604" y2="1585.3604"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="89" x="487.5" y="1571.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="71" x="493.5" y="1588.2734">Forum load</text><polygon fill="#000000" points="598.5,1637.6367,608.5,1641.6367,598.5,1645.6367,602.5,1641.6367" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="86.5" x2="604.5" y1="1641.6367" y2="1641.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93.5" y="1629.2393">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="115.5" y="1621.584">GET /posts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="425" x="115.5" y="1636.8945">[Refresh token and JWT HttpOnly w/ domain: Forums.Example.com]</text><polygon fill="#000000" points="97.5,1666.9473,87.5,1670.9473,97.5,1674.9473,93.5,1670.9473" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="91.5" x2="609.5" y1="1670.9473" y2="1670.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="103.5" y="1666.2051">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="125.5" y="1666.2051">(Forum posts HTML)</text><path d="M56,1733.9473 L56,1758.9473 L1055,1758.9473 L1055,1743.9473 L1045,1733.9473 L56,1733.9473 " fill="#800080" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M1045,1733.9473 L1045,1743.9473 L1055,1743.9473 L1045,1733.9473 " fill="#800080" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="505.5" y="1751.5156">Attack vectors</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="1834.9131"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="1834.9131" y2="1834.9131"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="1837.9131" y2="1837.9131"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="145" x="459.5" y="1824.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="465.5" y="1840.8262">Stolen refresh token</text><polygon fill="#000000" points="553.5,1890.1895,543.5,1894.1895,553.5,1898.1895,549.5,1894.1895" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="547.5" x2="1024.5" y1="1894.1895" y2="1894.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="559.5" y="1881.792">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="581.5" y="1874.1367">GET /shopping-cart</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="437" x="581.5" y="1889.4473">[Refresh token and bad JWT HttpOnly w/ domain: Store.Example.com]</text><polygon fill="#000000" points="866.5,1934.8105,876.5,1938.8105,866.5,1942.8105,870.5,1938.8105" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="542.5" x2="872.5" y1="1938.8105" y2="1938.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="549.5" y="1926.4131">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="290" x="571.5" y="1918.7578">POST /oauth2/token or POST /api/jwt/refresh</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="571.5" y="1934.0684">(grant_type=refresh and refresh token)</text><polygon fill="#000000" points="553.5,1964.1211,543.5,1968.1211,553.5,1972.1211,549.5,1968.1211" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="547.5" x2="877.5" y1="1968.1211" y2="1968.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="559.5" y="1963.3789">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="581.5" y="1963.3789">(JWT)</text><polygon fill="#000000" points="1013.5,2008.7422,1023.5,2012.7422,1013.5,2016.7422,1017.5,2012.7422" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="542.5" x2="1019.5" y1="2012.7422" y2="2012.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="549.5" y="2000.3447">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="571.5" y="1992.6895">(Shopping cart HTML)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="323" x="571.5" y="2008">[New JWT HttpOnly w/ domain: Store.Example.com]</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1058" x="3" y="2041.3975"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="2041.3975" y2="2041.3975"/><line style="stroke: #000000; stroke-width: 0.5;" x1="3" x2="1061" y1="2044.3975" y2="2044.3975"/><rect fill="#EEEEEE" height="23.3105" style="stroke: #000000; stroke-width: 1.0;" width="84" x="490" y="2030.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="496" y="2047.3105">Stolen JWT</text><polygon fill="#000000" points="553.5,2096.6738,543.5,2100.6738,553.5,2104.6738,549.5,2100.6738" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="547.5" x2="1024.5" y1="2100.6738" y2="2100.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="559.5" y="2088.2764">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="581.5" y="2080.6211">GET /shopping-cart</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="581.5" y="2095.9316">[JWT HttpOnly w/ domain: Store.Example.com]</text><polygon fill="#000000" points="1013.5,2125.9844,1023.5,2129.9844,1013.5,2133.9844,1017.5,2129.9844" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="542.5" x2="1019.5" y1="2129.9844" y2="2129.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="549.5" y="2125.2422">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="571.5" y="2125.2422">(Shopping cart HTML)</text><!--
@startuml
skinparam shadowing false
skinparam NoteBackgroundColor #LightBlue
skinparam NoteBorderColor #CornflowerBlue
skinparam ParticipantBackgroundColor #LightGray
skinparam ParticipantBorderColor #Gray
skinparam SequenceArrowColor #Black
skinparam SequenceLifeLineBorderColor #Black
skinparam SequenceDividerTextAlignment center
skinparam SequenceDividerFontStyle Normal
skinparam SequenceDividerBorderThickness 1
participant Browser
participant Store
participant Forums
participant FusionAuth
participant Hacker
note over Browser, Hacker : [] = cookies\n{} = request/response parameters\n() = request/response body
== Initialize ==
autonumber
Browser->Store : GET /
Store->Browser : (HTML, CSS & JavaScript - with login link)

  == Login (inside WebApp) ==
  Browser->Store : GET /login
  Store->Browser : (Login form HTML)
  Browser->Store : POST /login
  Store->FusionAuth : POST /api/login
  FusionAuth->Store : (User, Refresh Token and JWT)
  Store->Browser : 302 Location: /shopping-cart\n[Refresh Token and JWT HttpOnly w/ domain: Store.Example.com]

== Shopping cart load ==
Browser->Store : GET /shopping-cart\n[Refresh token and JWT HttpOnly w/ domain: Store.Example.com]
Store->Browser : (Shopping cart HTML)

note over Browser #red;line:white : <color white>JWT expires</color>

== Shopping cart load ==
Browser->Store : GET /shopping-cart\n[Refresh token and JWT HttpOnly w/ domain: Store.Example.com]
Store->FusionAuth : POST /oauth2/token or POST /api/jwt/refresh\n(grant_type=refresh and refresh token)
FusionAuth->Store : (JWT)
Store->Browser : (Shopping cart HTML)\n[New JWT HttpOnly w/ domain: Store.Example.com]

note over Browser #red;line:white : <color white>Refresh token expires</color>

== Re-login ==
Browser->Store : GET /shopping-cart\n[Refresh token and JWT HttpOnly w/ domain: Store.Example.com]
Store->FusionAuth : POST /oauth2/token or POST /api/jwt/refresh\n(grant_type=refresh and refresh token)
FusionAuth-[#red]>Store : <color red>404 Missing</color>
Store->Browser : 302 Location: /login
Browser->Browser : Login same as above

  ||50||
  note over Browser, Hacker #purple;line:white : <color white>SSO login to forums - not provided by FusionAuth for this workflow</color>
  ||50||

create Forums

== Initialize ==
Browser->Forums : GET /\n[No cookies]
Forums->Browser : (HTML, CSS & JavaScript - with login link)

  == Login (inside SPA) ==
  Browser->Forums : GET /login
  Forums->Browser : (Login form HTML)
  Browser->Forums : POST /login
  Forums->FusionAuth : POST /api/login
  FusionAuth->Forums : (User, Refresh Token and JWT)
  Forums->Browser : 302 Location: /posts\n[Refresh Token and JWT HttpOnly w/ domain: Forums.Example.com]

== Forum load ==
Browser->Forums : GET /posts\n[Refresh token and JWT HttpOnly w/ domain: Forums.Example.com]
Forums->Browser : (Forum posts HTML)

||50||
note over Browser, Hacker #purple;line:white : <color white>Attack vectors</color>
||50||

== Stolen refresh token ==
Hacker->Store : GET /shopping-cart\n[Refresh token and bad JWT HttpOnly w/ domain: Store.Example.com]
Store->FusionAuth : POST /oauth2/token or POST /api/jwt/refresh\n(grant_type=refresh and refresh token)
FusionAuth->Store : (JWT)
Store->Hacker : (Shopping cart HTML)\n[New JWT HttpOnly w/ domain: Store.Example.com]

== Stolen JWT ==
Hacker->Store : GET /shopping-cart\n[JWT HttpOnly w/ domain: Store.Example.com]
Store->Hacker : (Shopping cart HTML)
@enduml

PlantUML version 1.2018.11(Sat Sep 22 10:43:53 MDT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b28
Operating System: Mac OS X
OS Version: 10.14.3
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>