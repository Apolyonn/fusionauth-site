---
layout: advice
title: What is OAuth?
description: What is OAuth and when should you use it?
image: advice/what-is-oauth/expert-advice-what-is-oauth-and-why-should-you-use-it.png
author: Ahmed Hashesh
category: OAuth
date: 2022-01-27
dateModified: 2022-01-27
---

Open Authorization (OAuth) is an open-standard authorization protocol for internet token-based authorization. OAuth allows services, like Facebook and Google or your own APIS, to manage access to an end user's account information without disclosing the user's credentials. 

First, an authorization flow is used to authenticate and authorize a third-party service. After that, an access token is generated and shared with the third-party service which allows the account information to be accessed. Passwords are never shared because OAuth2 lets you authorize an application to communicate with another on your behalf.

Instead of passing authentication data between customers and service providers, OAuth2 provides a time bound token. Therefore, developers get access to end-user data in a more secure manner.

In this article, you’ll learn how OAuth works, how versions 1 and 2 differ, and why you should use OAuth2 instead of your own authorization solution. 

## Why OAuth

OAuth in general was designed as a reaction to the [direct authentication pattern](http://guides.brucejmack.net/SOA-Patterns/WSSP/1.3DirectvsBrokeredAuthDoc.htm), which asks the user for their username and password. When utilizing OAuth2, the user still provides this information, but they are able to log into one platform and use tokens generated by that platform to grant access to data and perform actions in one or more other applications.

Before OAuth was prevalent, websites would ask users to enter a username and password into a form, for example the credentials for a Gmail account, to gain access to data from Gmail. Soon, users realized they didn’t want to grant the full access provided by sharing their username and password with any old service. They preferred limited access. For example, a user might want a third party service to access their email account, but only have rights to read contacts, not send email or add contacts.

This article will focus on OAuth2, the second version of OAuth, though below we do cover the differences between the versions.

With the help of OAuth2, a token, which has a limited lifetime, provides limited access. With the introduction of OAuth2, connecting multiple applications became easier for users, and more secure, since user credentials are not shared. Authentication is also easier for developers to manage because they only need to integrate OAuth2 in their application instead of having their own database to store users' sensitive information.

## How OAuth2 Works

Usually, OAuth2 is involved when a user (also called the resource owner) is providing a third-party application (called a client application) access to a resource on a resource server without sharing their credentials with the third-party application. 

Let’s make it more concrete with an example.

If you wanted to print images from your Pinterest account without downloading the images and uploading them again to a printing website, and without sharing your Pinterest username and password with the printing website, you could authorize the printing website (which is the third-party application) to have limited access to your Pinterest account.

You can do this using OAuth2:

DIAGRAM 

1. The printing website (third-party app or client) redirects you to Pinterest (which is the resource server, as it has access to the images you are trying to print). 
2. You log in (since Pinterest needs to know who you are) to an authorization server, also probably managed by Pinterest. 
3. As part of the logon process, the authorization server asks you if you  want to give access to a third-party application. If you say yes, it sends an authorization code to   the third-party application.
4. The app uses this authorization code and some previously agreed upon credentials which are tied to the application, to get an access token from the authorization server. So the authorization server has the authorization code, which represents the choices the user made, and the application credentials. It verifies both of these and generates an access token.
5. The printing website app receives the access token and stores it safely.
6. The app sends the access token to the Pinterest resource server with a request for the images
7. The images are returned.

In these steps, the user never shares their credentials with the third-party app, instead the app gains access based on the authorization server which confirms the user identity. 

OAuth2 isn't the first authentication/authorization mechanism to act on behalf of the user. Many authentication systems, including [Kerberos](https://web.mit.edu/kerberos/), operate in the same way. However OAuth2 is unique because its delegated authorization framework is the first to be widely accepted and function across the web.

### Additional OAuth2 Concepts

The authorization process consists of several parties, including the resource owner, the resource server, the authorization server, and the client. As mentioned before, the third-party application obtains tokens from the authorization server and uses these tokens to access the resources in the resource server. Like any other technical topic, there are certain common concepts. These include: 

* Scopes
* Grants
* Tokens
* Client Ids

Let’s take a look at these concepts. 

#### Scope

A scope is a method of restricting access. Remember in the example above, when the user only wanted to give access to Gmail contacts and not the ability to send emails?

This limited permissioning happens with scopes. Instead of giving applications full access to a user's account, it enables apps to request a limited, well, scope of what they can do on the user's behalf. 

For example, some apps use OAuth2 to identify users and therefore only require a user Id and basic profile information. Other applications may require access to more sensitive data, like the user's birthdate or the ability to post data on the user's behalf and edit profile data. 

Users are more likely to allow an app to gain access to personal data if they understand what exactly the app can and can’t do. Scopes allow them to make informed decisions about what they consent to share  with the third-party application.

#### Grants

Grants are authentication flows for obtaining access tokens from the authorization server. The grant encapsulates a process, data flow and rules used to generate a token.

The core OAuth2 grants (as outlined in RFC 6749) are:

* **Authorization Code Grant:** The fundamental attribute of this grant is the one time authorization code generated from the authorization server after authenticating the resource owner. This is exchanged for the token using server side code. 
* **Implicit Grant:** A simplified form of authorization used by browser based applications implemented using JavaScript. This is a legacy grant type. Don’t use this grant.
* **Resource Owner Credentials:** Helpful when the username and password are required for authorization with first-party applications. Also called the Password grant. It should only be used if there is a high level of trust between the resource owner and the third-party application or for migrating from legacy systems to OAuth2 based systems.
* **Client Credentials:** The right grant when the application is trying to act on behalf of itself without the user’s presence like a third-party application trying to access resources it already has authorization to access. 

#### Access Tokens

Programs use access tokens to make requests on a user's behalf. As mentioned above, the access token denotes a particular application's permission to access certain elements of a user's data.

Access tokens must be kept private. Passing the token through non-encrypted channels makes it easier for replay attacks which is why it’s recommended for OAuth2 2.0 to be used with Transport Layer Security (TLS).

#### Client Ids

OAuth2 typically requires static, out of band configuration. For example, before an application can call a Google API to retrieve contact information on behalf of a user, it must first receive approval from Google. This process is called "Client Registration" and can be done manually or in certain circumstances programmatically.
During the client registration, the third party application provides information like the client type, a redirect URL where the authorization code can be sent, and other related information including a website and description. The authorization server then generates a client Id and a client secret.

The client type, either confidential or public, is chosen based on the client’s ability to authenticate with the authorization server. The redirect URL is where the user will be redirected after the authorization process is complete.

### Benefits and Features of OAuth2

Some of the advantages of integrating OAuth2 into your application include:

* Allowing you to read data about a user from another application without handling user credentials.
* Managing the authorization process for online, desktop, and mobile apps rather than creating a separate process for each type of application.
* Providing consumers more control over their data by authorizing access to specific capabilities for the applications they wish to use on a case-by-case basis.
* Isolating all authentication processing, allowing for additional security methods such as MFA to be implemented without affecting any applications.

## How OAuth2 Differs from OAuth1

OAuth2 is the second version of OAuth, and is incompatible with the first version. OAuth2 is a complete rewrite of the protocol from scratch, which made the two versions suitable for different needs. Frankly OAuth1 is rarely seen in the wild, apart from [Twitter's API](https://developer.twitter.com/en/docs/authentication/overview).

OAuth1 was written based on Flickr’s authorization API and Google’s AuthSub. However, challenges arose and paved the way for another version.

The developers of the second version wanted to address the following issues that were present in OAuth1:

* Poor support for the non-browser based applications.
* No separation between the servers performing user authorization and servers that handle the OAuth requests.
* Complicated signatures and the need to have solid cryptography background and key management skills to handle the OAuth integration.

This lead to significant differences between the two versions, including:

* OAuth2 supports six grants compared to three in the first version, which is better for non-browser based applications.
* Signatures are less complicated in OAuth2.
* Access tokens have a short life in OAuth2. This causes issues, which were mitigated by the concept of refresh tokens.
* The terminology differs in regards to the authorization server and the resource server.

OAuth2 has a different security profile than OAuth 1 because it’s more transport dependent, flexible, and less prescriptive than the first version. The developers of OAuth2 focused on making it more interoperable and versatile across sites and devices. They also included token expiration. Many of the original creators of OAuth 1 and supporters, regardless of their intentions, refused to accept version 2 because:

* The second version is incompatible with the first version. The developers intended for OAuth2 to replace the first version everywhere. 
* OAuth2 doesn’t explicitly specify or enable encryption, signatures, client verification, or channel binding (tying a particular session or transaction to another particular client and server). Instead, it requires implementers to deliver those functionalities via an external security protocol like TLS. In OAuth2 1 each message was individually signed.
* OAuth2 uses bearer tokens, which makes it easier to integrate but less secure. (There are efforts to introduce proof of possession/token binding to OAuth2, such as MTLS and DPoP.)

### OAuth2 Best Practices

According to the [OAuth2 Security Best Current Practice](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics), the Implicit Grant is not recommended as it is vulnerable to access token leaks. Many individuals have attempted to abuse OAuth2 across applications, so it’s important to follow basic web security rules as well.

For example, to maintain the integrity of the flow:

* Always use a [CSRF (Cross-Site Request Forgery)](https://owasp.org/www-community/attacks/csrf) token with the state parameter.
* To guarantee accurate URI (Uniform Resource Identifier) validations, always whitelist redirect URIs.
* Always use TLS for all OAuth2 requests.
* Use a client Id to associate the same client with authorization grants and token requests.
* Secrets should never be exposed. For example, don’t include a client secret in a mobile application available. 
* Store all access tokens securely, since they are bearer tokens and if stolen, can be misused.

In general, implement the recommendations introduced in the [OAuth2 Security Best Current Practice](https://datatracker.ietf.org/doc/draft-ietf-oauth-security-topics/)

## OAuth2 is Not an Authentication Protocol

One final note. OAuth2 is an authorization framework, not an authentication protocol. Your authorization policy decisions are decoupled from authentication using OAuth2. Even though authentication is critical to grant, the access token itself doesn't necessarily contain information about a specific user, just what the holder of the token can access. It allows for the ideal mix of fine and coarse-grained authorization. 

You can use [OpenID Connect](https://openid.net/connect/) to extend OAuth2 for authentication scenarios, where you need to know who is requesting access, rather than whether an entity has access to a protected resource. Most OAuth2 servers support OIDC, and it uses the same grants with an additional set of scopes. 

## Benefits of Using OAuth2 Instead of Your Own Solution

OAuth2 provides you with technical advantages such as a central choke point to manage, limit and control access to services.
With OAuth2, you have the benefits of a standard. This includes a team of experts working to push the standard forward in terms of functionality and security, a wide set of libraries that work with the standard, and a population of developers who understand the protocol. Compare that to a homegrown authorization protocol, which has none of these advantages.

In addition, implementing your own solution may be more time-consuming than buying one. You would need resources and knowledge to implement and maintain your custom solution.

## Conclusion

OAuth2 is a delegated access authorization system for  services accessing  private resources..

In this article, you looked at what OAuth2 is, key concepts, an example application, what problems it solves, and why you might use it rather than creating your own authentication solution.



