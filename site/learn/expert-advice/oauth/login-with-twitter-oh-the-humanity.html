---
layout: advice
title: "Login with Twitter - Oh, the Humanity!"
description: "Twitter doesn't make it easy to build an OAuthv1 login. FusionAuth does."
image: fusionauth-share-image.jpg
header_dark: true
categories:
- oauth
---

<section>
  <div class="container">
    <div class="row">
      <article class="col-12 col-lg-9">
        <div class="">
          <div class="pt-5 ">
            <p><a href="/learn/expert-advice">Expert Advice</a> > <a href="/learn/expert-advice/oauth/">OAuth</a></p>
          </div>
          <h1>Login with Twitter - Oh, the Humanity!</h1>
          <p>Daniel Degroff</p>
          <i class="fal fa-star text-primary mb-3"></i>
          <i class="fal fa-star text-primary mb-3"></i>
          <i class="fal fa-star text-primary mb-3"></i>
          <i class="fal fa-star text-primary mb-3"></i>
          <i class="fal fa-star text-primary mb-3"></i>
        </div>
        <div class="embed-responsive embed-responsive-2by1">
          <div class="embed-responsive-item text-center">
            <img class="post-image" src="/assets/img/blogs/login-with-twitter.png">
          </div>
        </div>
      </article>
      <article class="col-12 col-lg-9">
        <div class="post-body mt-5">
          <div class="post-body-content">

            <p>When we built out our social login support in FusionAuth we were forced to navigate the harrowing path to signing our OAuth v1 requests to Twitter.

            If you've ever done this in Java, you may know there isn't a great option off the shelf to make this easy, or if there is I was unable to find it. Since we had to do some heavy lifting, we decided to share our work with the Java community.

            TL;DR See source code on <a href="https://gist.github.com/robotdan/33f5834399b6b30fea2ae59e87823e1d">Gist</a>.
</p>

<!--more-->

<h2 id="sifting-through-the-disaster-that-is-twitter-login">Sifting through the disaster that is Twitter login</h2>

<p>If you have ever built out a Twitter login integration you’ve likely read through the <a href="https://developer.twitter.com/en/docs/twitter-for-websites/log-in-with-twitter/guides/implementing-sign-in-with-twitter.html">Twitter documentation</a>.</p>

<p>If you can navigate their documentation, you get a gold star. This task is not for the faint of heart. The most difficult part of making the OAuth v1 requests is building the required signature. The Twitter documentation does little to make this a simpler process.</p>

<p>Here is the summary provided by Twitter on how to build a <a href="https://developer.twitter.com/en/docs/basics/authentication/guides/creating-a-signature.html">signed request</a>.</p>

<blockquote class="text">
  <p>These values need to be encoded into a single string which will be used later on. The process to build the string is very specific:
<br /><br /></p>
  <ol>
    <li>Percent encode every key and value that will be signed.</li>
    <li>Sort the list of parameters alphabetically [1] by encoded key [2].</li>
    <li>For each key/value pair:</li>
    <li>Append the encoded key to the output string.</li>
    <li>Append the ‘=’ character to the output string.</li>
    <li>Append the encoded value to the output string.</li>
    <li>If there are more key/value pairs remaining, append a ‘&amp;’ character to the output string.</li>
  </ol>
</blockquote>

<p>The first time I read this, I threw up in my mouth. I then went and read the OAuth Core 1.0 specification to ensure I understood the procedure. If you’re interested, go read <a href="https://oauth.net/core/1.0a/#signing_process">section 9</a> of <a href="https://oauth.net/core/1.0a/">OAuth Core 1.0 Revision A</a></p>

<p>In summary, it is easy to see why the OAuth v1 specification was deprecated in favor of OAuth 2.0 which relies upon a secure transport (TLS) instead of requiring cumbersome signing strategies.</p>

<p>With that said, to make my life easier, and hopefully some other fellow Java developers, I wrote an OAuth v1 signature builder that I could use to sign my requests to Twitter.</p>

<h2 id="gather-your-keys">Gather your Keys</h2>

<p>Start by logging into Twitter and navigating the Twitter developer console. Once you’re there, navigate to the <code class="highlighter-rouge">Keys and tokens</code> tab of the application you’re integrating. Here you will find a few key pieces of information that you’ll need to sign the request.</p>

<p><img src="/assets/img/docs/twitter-keys-tokens.png" alt="Twitter Consumer API Keys" class="full" style="" /></p>

<p>Make note of the two values in the <code class="highlighter-rouge">Consumer API Keys</code> section, they are suffixed with the labels <code class="highlighter-rouge">API key</code> and <code class="highlighter-rouge">API secret key</code>. Once you are in the OAuth v1 world, we’ll be using the <code class="highlighter-rouge">API key</code> value for the consumer key and the <code class="highlighter-rouge">API secret key</code> value for the consumer secret.</p>

<p>In the above Twitter configuration screenshot we have an <code class="highlighter-rouge">API key</code> value of <code class="highlighter-rouge">T62nvXkMrZyTeRYK2vBmGiFUq</code> and an <code class="highlighter-rouge">API secret key</code> value of <code class="highlighter-rouge">gikDkNsIS7Xpc1eFtgt38lnZFBarywiOtEyyUBGZ3x2fj6d3gz</code>. We’ll use those values in the next section to build an example <code class="highlighter-rouge">Authorization</code> header.</p>

<h2 id="example-code">Example code</h2>

<p>Here is a Java example of building the <code class="highlighter-rouge">Authorization</code> header value for a <code class="highlighter-rouge">POST</code> request to the Twitter <code class="highlighter-rouge">request_token</code> endpoint. This is the first endpoint you will use which is required to obtain a Request Token.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">authorization</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OAuth1AuthorizationHeaderBuilder</span><span class="o">()</span>
            <span class="o">.</span><span class="na">withMethod</span><span class="o">(</span><span class="s">"POST"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withURL</span><span class="o">(</span><span class="s">"https://api.twitter.com/oauth/request_token"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withConsumerSecret</span><span class="o">(</span><span class="s">"gikDkNsIS7Xpc1eFtgt38lnZFBarywiOtEyyUBGZ3x2fj6d3gz"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withParameter</span><span class="o">(</span><span class="s">"oauth_callback"</span><span class="o">,</span> <span class="s">"https://login.piedpiper.com/callback"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withParameter</span><span class="o">(</span><span class="s">"oauth_consumer_key"</span><span class="o">,</span> <span class="s">"T62nvXkMrZyTeRYK2vBmGiFUq"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withParameter</span><span class="o">(</span><span class="s">"oauth_nonce"</span><span class="o">,</span> <span class="s">"tp9pdk9frXwLOwt3"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</code></pre></div></div>

<p>Next we’ll take the string returned by the builder and build an <code class="highlighter-rouge">Authorization</code> HTTP header. Line breaks are added for readability.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Authorization: OAuth oauth_callback="https%3A%2F%2Flogin.piedpiper.com%2Fcallback",
                     oauth_consumer_key="T62nvXkMrZyTeRYK2vBmGiFUq",
                     oauth_nonce="tp9pdk9frXwLOwt3",
                     oauth_timestamp="1554175774",
                     oauth_signature_method="HMAC-SHA1",
                     oauth_version="1.0",
                     oauth_signature="tYJE4EV0ZoXYX6jsAfQuQvLpjOA%3D"
</code></pre></div></div>

<p>It is as simple as that, now for each request you make to Twitter as part of the OAuth v1 authentication workflow, you simply need to build the <code class="highlighter-rouge">Authorization</code> header using the <code class="highlighter-rouge">OAuth1AuthorizationHeaderBuilder</code> class.</p>

<p>To clarify, the easiest way to login with Twitter is to use FusionAuth. However if you find that you need to build your own Twitter login, or need to interact with any other OAuth v1 identity provider we’ve got you covered.</p>

<p>Now for the source code.</p>

<script src="https://gist.github.com/robotdan/33f5834399b6b30fea2ae59e87823e1d.js"></script>

<p> </p>
<h2 id="learn-more-about-fusionauth">Learn More About FusionAuth</h2>
<p>FusionAuth is designed to be the most flexible and secure Customer Identity and Access Management solution available at the best price. We provide registration, login, passwordless login, SSO, MFA, data search, social login, user management and more, 100% free for unlimited users.</p>

<p><a href="/" title="FusionAuth Home" class="btn btn-primary">Learn More</a></p>


          </div>

<div class="text-center mt-5 mb-5 py-5">
  <hr>
    <div class="mt-5 mb-5">
      <p>How helpful was this article? Click a star to rate.</p>
      <i class="fal fa-star text-primary mb-3"></i>
      <i class="fal fa-star text-primary mb-3"></i>
      <i class="fal fa-star text-primary mb-3"></i>
      <i class="fal fa-star text-primary mb-3"></i>
      <i class="fal fa-star text-primary mb-3"></i>
    </div>
  <hr>
</div>

<!-- comments -->
          <div class="post-body-comments">
            <div class="just-comments" data-apikey="edc7b4a8-97ce-47ba-9e21-0477407197ef"></div>
            <script async src="https://just-comments.com/w.js"></script>
          </div>
        </div>
      </article>


      <!-- side bar -->
      <div class="col-12 col-lg-3">
        <div class="mt-5">
          <div class="p-4 border">
            <h2>Related Articles</h2>

            <a class="d-block mt-3 mb-3 link-dark" href="/blog/2019/10/29/oauth-device-authorization-roku-appletv-xbox">How-To: OAuth Device Authorization for Roku, AppleTV, and XBox</a>

            <a class="d-block mt-3 mb-3 link-dark" href="/blog/2019/10/09/build-fusionauth-python-login-web-app-flask">Title</a>

            <a class="d-block mt-3 mb-3 link-dark" href="/blog/2019/10/08/deactivating-reactivating-deleting-user-fusionauth-python">Deactivating, Reactivating, and Deleting A FusionAuth User in Python</a>

            <a class="d-block mt-3 mb-3 link-dark" href="/blog/2019/10/02/storing-user-data">Storing User Data in FusionAuth</a>

          </div>
          <div class="mt-4 mb-4 bg-secondary p-4 text-center text-white">
            <img class="w-100" src="/assets/img/fusionauth-logo-white-orange.svg">
            <p class="mt-4 text-light">
              FusionAuth provides authentication, authorization, and user management for every app: deploy anywhere, integrate with anything, in minutes.
            </p>
            <a class="btn btn-lg btn-primary text-uppercase mt-3 mb-4">Get Started for Free</a>
          </div>

        </div>
      </div>
    </div>
  </div>
</section>


<section class="bg-secondary pt-6 pb-6">
  <div class="container text-center text-white">
    <h2 class="text-white h1">FusionAuth is Auth Built for &lt;devs&gt;</h2>
    <p class="h5 text-white mt-4">FusionAuth gives devs complete flexibility with minimal implementation effort. Use our Fast Path install to get started in minutes.</p>
    <a href="/" class="btn btn-primary btn-lg mt-4 mb-4">Learn More</a>
    <h4 class="text-light mb-4">We got this. Go build the cool stuff.</h4>
    <img src="/assets/img/fusionauth-logo-white-orange.svg" alt="FusionAuth Logo" class="m-auto mt-4 mb-4" style="max-width: 250px">
  </div>
</section>

{% include macros/subscribe.html %}
