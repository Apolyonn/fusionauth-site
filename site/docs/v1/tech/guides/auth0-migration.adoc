---
layout: doc
title: Migration Guide
description: How to migrate your users to FusionAuth.
---
:page-liquid:

== Overview

This document will help you migrate off of Auth0. If you are looking to compare FusionAuth and Auth0, link:/blog/2018/10/19/auth0-and-fusionauth-a-tale-of-two-solutions/[this document may help]. 

This guide assumes you have installed FusionAuth. If you have not, please link:/docs/v1/tech/installation-guide/[view our installation guides] and install FusionAuth before you begin. For more general migration information, please view the link:/docs/v1/tech/guides/migration/[FusionAuth migration guide].

TBD TOC

There are a number of different ways you can integrate with Auth0, and it would be difficult to cover them all. This guide touches on the major pieces of a migration, but focuses on moving your user data from an Auth0 managed user database into FusionAuth. 

== Planning Considerations

=== Obtaining User Data

You can use either the Auth0 management API or the Auth0 user interface to export user data. This guide will use the user interface, but if you have a large number of users, the https://auth0.com/docs/api/management/v2#!/Users/get_users[management API is recommended]. Auth0 also has a https://auth0.com/docs/support/export-data[high level export guide] worth reviewing.

Your users' usernames and other data can be obtained by installing an extension and downloading the data. The password can be obtained by opening a support ticket.

Here's a brief video walking through the export process, which is further documented below.

video::wQklLZZP_3s[youtube,width=560,height=315]

=== Mapping User Attributes

The attributes of the user object in FusionAuth are link:/docs/v1/tech/apis/users/[well documented]. 

If there is an attribute in your Auth0 user which cannot be direclty mapped to a FusionAuth user attribute, you can place it to the `user.data` field. This field can store arbitrary JSON.

=== Other Entities

There are other important entities, such as connections or roles, that may need to be migrated. There are typically fewer of these, so an automated migration may not make sense, but plan for moving this configuration in some form.

The other difficulty with this type of entity is that the functionality may not be the same between Auth0 and FusionAuth. Contrast this with users, where if you can migrate the username and the password information, they can authenticate. It is highly recommended to link:/download/[download FusionAuth] before you begin a migration and do a proof of concept to learn more about these differences. 

A partial list of configuration that may need to be migrated includes the following:

* In Auth0, Connections are a source of data for users. FusionAuth calls these link:/docs/v1/tech/identity-providers/[Identity Providers].
* Rules, Hooks and Actions are ways for you to customize authentication or authorization workflows. FusionAuth has a similar concept called link:/docs/v1/tech/lambdas/[Lambdas].
* With Auth0, APIs, Applications and SSO Integrations are what your users can log in to. They are also called Clients in the Auth0 documentation. FusionAuth refers to these as link:/docs/v1/tech/core-concepts/applications/[Applications]. 
* Tenants are a high level construct which groups other entities such as users and applications together. FusionAuth calls these link:/docs/v1/tech/core-concepts/tenants/[Tenants] as well.
* For Auth0, Roles and Permissions provide information about what your users can do in your custom or off the shelf applications. FusionAuth has link:/docs/v1/tech/core-concepts/roles/[Roles] and they are defined on an Application by Application basis. Read more about the link:/docs/v1/tech/core-concepts/authentication-authorization/[difference between authentication and authorization] in FusionAuth.

[NOTE]
====
In FusionAuth, users are mapped to applications with a link:/docs/v1/tech/core-concepts/registrations/[Registration]. 

Auth0, in contrast, gives users access to all Auth0 applications in a tenant by default. 
====

=== Universal Login

Auth0 provides a login experience called Universal Login. This is a complex, configurable login component that works with SPAs, native applications and web applications. 

FusionAuth's login experience is less complicated. You can choose to build your own login pages or use FusionAuth's hosted login pages. link:/docs/v1/tech/core-concepts/integration-points/#login-options[Read more about these choices].

Once you've planned your migration, export your user data from Auth0.

== Exporting Users

To export users with the user interface, log in and go to your dashboard. You'll perform the following steps:

1. Add the User Import/Export extension, if not present
2. Run the extension
3. Download the exported file

Let's walk through each of these steps.

=== Add the Extension

Auth0 provides an extension that allows you to both import and export users to and from Auth0. Add the extension by navigating to [breadcrumb]#Extensions# and searching for it.

image::guides/auth0-migration/find-user-export-extension.png[Finding the import/export extension.,width=1200,role=bottom-cropped]

After you find the extension, install it:

image::guides/auth0-migration/user-export-extension-install.png[Installing the import/export extension.,width=1200,role=bottom-cropped]

The next step is to run the extension. 

=== Run the Extension

Next, run the extension. The first time you run it, you'll be asked to grant needed permissions. Then, choose the export tab. 

This will bring up a screen with information such as what fields you want to export, which connections to pull users from, and the export file format.

image::guides/auth0-migration/user-export-extension-export-run.png[Running the import/export extension.,width=1200,role=bottom-cropped]

For this guide, export user information as JSON. Choose the default user database. Finally, if you have special fields to include, configure them to be exported. Then begin the export.

image::guides/auth0-migration/auth0-export-complete.png[View when the the import/export extension is finished.,width=1200,role=bottom-cropped]

Depending on how many users you have in your database, it may take a while for this to complete.

=== Download the File

After the export finishes, download the file provided. At the end of the process, you'll end up with a JSON file like this:

[source,json,title=Sample Auth0 user data export download]
----
{"user_id":"auth0|60425da93519d90068f82966","email":"test@example.com","name":"test@example.com","nickname":"test","created_at":"2021-03-05T16:34:49.518Z","updated_at":"2021-03-05T16:34:49.518Z","email_verified":false}
{"user_id":"auth0|60425dc43519d90068f82973","email":"test2@example.com","name":"test2@example.com","nickname":"test2","created_at":"2021-03-05T16:35:16.786Z","updated_at":"2021-03-05T16:35:16.786Z","email_verified":false}
----

This is half of the data you'll need to migrate your users. The other half is the password hashes. Let's tackle that next.

== Exporting Passwords

Password hashes and related information such as the salt and encryption algorithm are sensitive information. Auth0 doesn't export them as part of the general import/export process. 

However, once you've imported the passwords, your users will be able to log in to FusionAuth with the same password they used previously. However, neither FusionAuth, Auth0 nor you know the password, only the one way hash of the password.

You must open a support ticket to get access to the hashes. To do so, from your dashboard, navigate to [breadcrumb]#Get Support#, and then open a ticket by scrolling to the bottom of the support page. 

image::guides/auth0-migration/create-ticket-start.png[The first step to getting your password hashes.,width=1200,role=top-cropped]

Select the issue and details of your request. Choose "I have a question regarding my Auth0 account" and then pick the "I would like to obtain an export of my password hashes" option.

[NOTE]
====
Auth0 requires you to be on a link:https://auth0.com/docs/support/export-data[paid plan] to export your password hashes. You cannot export them if you are on the free tier.

Auth0 makes no commitments about how long a password hash ticket will take. In the author's experience, it took approximately one week.

Plan accordingly. 
====

You'll receive an automated message after this ticket is submitted and you can view the progress on the ticket screen. 

After your request is processed and you've downloaded the file, you'll receive a JSON file containing the password hashes, related information and user ids. It might look a little something like this:

[source,json,title=Sample Auth0 password hash export download]
----
{"_id":{"$oid":"60425dc43519d90068f82973"},"email_verified":false,"email":"test2@example.com","passwordHash":"$2b$10$Z6hUTEEeoJXN5/AmSm/4.eZ75RYgFVriQM9LPhNEC7kbAbS/VAaJ2","password_set_date":{"$date":"2021-03-05T16:35:16.775Z"},"tenant":"dev-rwsbs6ym","connection":"Username-Password-Authentication","_tmp_is_unique":true}
{"_id":{"$oid":"60425da93519d90068f82966"},"email_verified":false,"email":"test@example.com","passwordHash":"$2b$10$CSZ2JarG4XYbGa.JkfpqnO2wrlbfp5eb5LScHSGo9XGeZ.a.Ic54S","password_set_date":{"$date":"2021-03-05T16:34:49.502Z"},"tenant":"dev-rwsbs6ym","connection":"Username-Password-Authentication","_tmp_is_unique":true}
----

Now that you have both the user data and the passwords, you can import your users.

== Importing Users

There are a few steps to take to import users. 

* Prepare your FusionAuth installation
* Get the import script and install needed gems
* Customize the script
* Run the script
* Test

Lets look at each of these in turn.

=== Set up FusionAuth

You need to set up FusionAuth so the migrated user data can be stored correctly. As mentioned above, this document assumes you have FusionAuth installed. If you don't, link:/docs/v1/tech/installation-guide/[view our installation guides] and get it installed before proceeding further.

==== Create a Test Tenant

Create a separate tenant for your migration process. Tenants logically isolate configuration settings and users, so if a migration goes awry or you need to adjust it, it's easy to delete the tenant and start with a clean system.

To add a tenant, navigate to [breadcrumb]#Tenants# and choose the green plus sign.

image::guides/auth0-migration/list-of-tenants-add-highlighted.png[Adding a tenant.,width=1200,role=bottom-cropped]

Give it a descriptive name like `Auth0 import test` and save it. You shouldn't need to modify any of the other configuration options to test importing users.

image::guides/auth0-migration/add-tenant.png[The tenant creation screen,width=1200,role=bottom-cropped]

Record the Id of the tenant, which will be something like `25c9d123-8a79-4edd-9f76-8dd9c806b0f3`. You'll use this in the import script.

image::guides/auth0-migration/list-of-tenants.png[The tenant list.,width=1200,role=bottom-cropped]

==== Create a Test Application

TBD

==== Add an API Key

The next step is to create an API key. To do so, navigate to [breadcrumb]#Settings -> API Keys# in the administrative user interface.

image::guides/auth0-migration/add-api-key.png[Adding an API key,width=1200]

This key needs to have the permission to run a bulk import of users. In the spirit of the principle of least privilege, give it the permission to `POST` to the `/api/user/import` endpoint. Record the API key string, as you'll use it below as well.

image::guides/auth0-migration/set-api-key-permissions.png[Setting API key permissions,width=1200]

=== Get the Script

FusionAuth has written an import script. It requires ruby (tested with 2.7). To get the script, clone the git repository:

[source,shell,title=Getting the import scripts]
----
git clone https://github.com/FusionAuth/fusionauth-import-scripts
----

Navigate to the `auth0` directory:

[source,shell,title=Navigate to the correct directory]
----
cd fusionauth-import-scripts/auth0
----

=== Install Needed Gems

The following gems must be available to the import script:

* `date`
* `json`
* `fusionauth_client`

If you have bundler installed, run `bundle install` in the `auth0` directory. Otherwise install the needed gems in some other way.

=== Configure the Script

Edit the `import.rb` script. You should update important variables:

[source,ruby,title=An excerpt of the import.rb]
----
#!/usr/local/bin/ruby -w

require 'date'
require 'json'
require 'fusionauth/fusionauth_client'

# BEGIN Modify these variables for your Import
users_file = 'users.json'
secrets_file = 'secrets.json'

$fusionauth_url = 'http://localhost:9011'
$fusionauth_api_key = 'bf69486b-4733-4470-a592-f1bfce7af580'

# Optionally specify the target tenant. If only one tenant exists this is optional and the users
# will be imported to the default tenant. When more than one tenant exists in FusionAuth this is required.
$fusionauth_tenant_id = '16970284-4680-4b3c-8a7e-424644ed1090'

# Map Auth0 userId to the FusionAuth User Id as a UUID
$map_auth0_user_id = false

# END Modify these variables for your Import
# ...
----

For this script to work correctly, update the following:

* `users_file` should point to the location of the user export file you obtained.
* `secrets_file` needs to point to the location of the password hash export file you received.
* `$fusionauth_url` must point to your FusionAuth instance. If you are testing locally, it will probably be `'http://localhost:9011'`.
* `$fusionauth_api_key` needs to be set to the value of the API key created above.
* `$fusionauth_tenant_id` should be set to the Id of the testing tenant created above.

You may or may not want to change `$map_auth0_user_id`. If you have external systems relying on the Auth0 user identifier, set this to `true`, which will ensure imported users have the the same Id as they did in Auth0. Otherwise, you can leave this variable set to `false`.

You may also want to migrate additional data. Currently, the following attributes are migrated:

* `user_id`
* `email
* `email_verified`
* `username`
* `insertInstant`
* `password` and supporting attributes

The migrated user will have the Auth0 tenant Id and original user Id stored on the `user.data` object. If you have additional user attributes you want to migrate, you should review and modify the `map_user` method. 

==== Enhancing the Script

You may also want to create Registrations, assign Roles, or associate users with Group, which you can do by creating the appropriate JSON data structures. These are documented in the link:/docs/v1/tech/apis/users/#import-users[Import User API docs]. This will require modifying the `import.rb` code.

For example, to add a Registration to an application with an Id of `6b72ba2d-679a-41dd-adb3-9f3e75e7cd1f`, add the following code to `map_user` before the `user` object is returned:

[source,ruby,title=Adding an application registration to every user]
----
# ...
user['registrations'] = []
application_registration = {
  applicationId: '6b72ba2d-679a-41dd-adb3-9f3e75e7cd1f'
}
user['registrations'].push(application_registration)
# ...
return user
----

=== Run the script

You can now run the import script:

[source,shell,title=Running the import script]
----
ruby ./import.rb
----

You'll see output like:

[source,shell,title=Import script output]
----
TBD
----

=== Verify the import

The next step is to log in to the FusionAuth administrative user interface and review the users. 

IMAGE 

If you have a test user, open an incognito window and log in with them to ensure the hashing migration was successful.

IMAGE

After the login, the user will end up at a URL like `https://fusionauth.io/?code=FlZF97WIYLNxt4SGD_22qvpRh4fZ6kg_N89ZbBAy1E4&locale=fr&userState=Authenticated`

This is because you haven't set up an application to handle the authorization code redirect. That'll be an important next step but is beyond the scope of this document. Consult the link:/docs/v1/tech/5-minute-setup-guide/[5 minute setup guide] for an example of how to do this.

=== The final destination of the imported users

After you are done testing, choose whether to import users into the default tenant or a new tenant. 

Whichever you choose, make sure to update `$fusionauth_tenant_id` to the correct value before running the import for a final time.

If you aren't keeping the users in the test tenant, delete the tenant as outlined below.

=== Deleting the test tenant

If you need to start over because the import failed or you need to tweak a setting, delete the tenant you created. This will remove all the users and other configuration for this tenant, giving you a fresh start. To do so, navigate to [breadcrumb]#Tenants# and choose the red trashcan icon. 

image::guides/auth0-migration/list-of-tenants-delete-highlighted.png[Deleting a a tenant.,width=1200,role=bottom-cropped]

Confirm your desire to delete the tenant. Depending on how many users you have imported, this may take some time.

== What to do next

At a minimum, assign your users to the relevant migrated FusionAuth applications. You can do this in two ways:

* As part of your import script by modifying the script and adding link:/docs/v1/tech/apis/users/#import-users[Registration JSON information] to the `map_user` method as illustrated in <<Enhancing the Script>>.
* After users have been migrated with the link:/docs/v1/tech/apis/registrations[Registrations API]. 

You'll also need to modify and test your applications to ensure that your users can log in to them and receive appropriate permissions and roles. 

If your application uses a standard OAuth, SAML or OIDC library to authenticate with Auth0, the transition should be relatively painless.

== Additional support

If you need support in your migration beyond that provided in this guide, you may:

* Post in our link:/community/forums/[community forums] 
* link:/pricing/editions/[Purchase a support contract]



